---
import * as style from "./speakers.css";
import Layout from "../components/Layout.astro";
import Speaker from "../components/Speaker.astro";
import { speakers, getAllTalks } from "../data/conference-data";

// On récupère uniquement les talks (pas les pauses, keynotes, etc.)
const talks = getAllTalks();

// On crée un objet qui associe chaque speaker à son talk
const speakersWithTalks = speakers.map(speaker => {
  const speakerTalk = talks.find(talk => talk.speakerId === speaker.id);
  return {
    ...speaker,
    talk: speakerTalk || null
  };
});

// On filtre pour n'avoir que les speakers qui ont un talk
const speakersToDisplay = speakersWithTalks.filter(speaker => speaker.talk);
---

<Layout pageClass={style.page}>
  <section class={style.speakers}>
    {speakersToDisplay.map(speaker => (
      <Speaker
        title={speaker.talk?.title || ""}
        name={speaker.name}
        abstract={speaker.talk?.abstract || ""}
      />
    ))}
  </section>
</Layout>
